<!DOCTYPE html>
<html lang="zh-Hant">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
Â  <title>Smart Google Review Â· AI ä¸€å‰‡çŸ­è©•</title>
Â  <style>
Â  Â  :root{
Â  Â  Â  --bg:#F5F7FB; --card:#FFFFFF; --fg:#0F172A; --muted:#64748B;
Â  Â  Â  --blue:#0A84FF; --blue-600:#0A84FF; --blue-500:#0A84FF; --blue-400:#49A2FF;
Â  Â  Â  --blue-300:#7CB9FF; --blue-200:#CDE5FF; --blue-100:#EAF4FF; --blue-050:#F3F9FF;
Â  Â  Â  --blue-hover:#49A2FF; --blue-active:#0A84FF; --on-blue:#FFFFFF;
Â  Â  Â  --chip-bg:var(--blue-100); --chip-bg-on:var(--blue-500); --chip-fg:#0F172A; --chip-fg-on:#FFFFFF;
Â  Â  Â  --fs-title-max:28px; --fs-title-min:18px; --fs-body:clamp(13px,1.2vw+10px,16px);
Â  Â  Â  --fs-chip:clamp(12px,1vw+8px,14px); --fs-btn:clamp(14px,1.2vw+11px,16px);
Â  Â  Â  --radius-lg:16px; --radius-md:12px; --radius-sm:10px;
Â  Â  Â  --shadow:0 10px 30px rgba(15,23,42,0.08); --shadow-soft:0 6px 20px rgba(15,23,42,0.06);
Â  Â  Â  --ring:0 0 0 3px color-mix(in oklab, var(--blue-300) 60%, transparent);
Â  Â  }
Â  Â  *{box-sizing:border-box; -webkit-tap-highlight-color:transparent;}
Â  Â  body{margin:0; background:var(--bg); color:var(--fg); font:var(--fs-body)/1.55 system-ui,-apple-system,Inter,'PingFang TC','Noto Sans TC',sans-serif;}
Â  Â  .wrap{max-width:760px; margin:auto; padding:12px;}
Â  Â  .card{background:var(--card); border-radius:20px; box-shadow:var(--shadow); overflow:hidden; position:relative;}
Â  Â  .hero-wrap{position:relative;}
Â  Â  .hero{width:100%; height:220px; object-fit:cover; display:none;}
Â  Â  @media (max-width:520px){ .hero{height:180px;} }
Â  Â  .lang-pill{position:absolute; right:12px; top:12px; display:flex; gap:6px; padding:6px; border-radius:999px; background:rgba(15,23,42,.45); backdrop-filter:blur(6px);}
EOT
Â  Â  .lang-pill button{border:0; background:transparent; padding:6px 12px; border-radius:999px; font-weight:700; color:#fff; min-width:42px; font-size:12px; cursor:pointer;}
Â  Â  .lang-pill button.active{background:#0B1020; color:#fff;}
Â  Â  .logo-badge{position:absolute; left:50%; bottom:-22px; transform:translateX(-50%); width:64px; height:64px; border-radius:14px; background:#fff; padding:8px; box-shadow:0 10px 30px rgba(15,23,42,.18), 0 2px 6px rgba(15,23,42,.1); display:none;}
Â  Â  .logo-badge img{width:100%; height:100%; object-fit:contain;}
Â  Â  @media (max-width:520px){ .logo-badge{width:56px; height:56px; bottom:-20px;} }
Â  Â  .content{padding:26px 16px 14px; margin-top:14px;}
Â  Â  .title{margin:0 0 6px 0; font-weight:800; line-height:1.2; font-size:var(--fs-title-max);}
Â  Â  .sub{color:var(--muted); margin:0 0 10px 0;}
Â  Â Â 
Â  Â  /* âœ… [æ–°å¢] "å•å·" å€å¡Šæ¨£å¼ */
Â  Â  .chip-group {
Â  Â  Â  margin-bottom: 20px;
Â  Â  }
Â  Â  .chip-group:last-child {
Â  Â  Â  margin-bottom: 12px;
Â  Â  }
Â  Â  .chip-group-title {
Â  Â  Â  font-size: 16px;
Â  Â  Â  font-weight: 700;
Â  Â  Â  color: var(--fg);
Â  Â  Â  margin: 0 0 12px 4px;
Â  Â  }
Â  Â  /* âœ… [ä¿®æ”¹] å°‡ #chips ID é¸æ“‡å™¨æ”¹ç‚º .chips class é¸æ“‡å™¨ */
Â  Â  .chips{display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px;}
Â  Â  @media (min-width:540px){ .chips{grid-template-columns:repeat(3,minmax(0,1fr));}}
Â  Â Â 
Â  Â  /* Positive chip (unselected) */
Â  Â  .chip{border-radius:999px; padding:10px 14px; background:var(--chip-bg); color:var(--chip-fg); display:flex; align-items:center; justify-content:center; cursor:pointer; user-select:none; border:1px solid var(--blue-200); transition:all .15s; box-shadow:var(--shadow-soft); min-height:48px;}
Â  Â  .chip:hover{transform:translateY(-1px); background:color-mix(in oklab, var(--blue-100) 60%, white);}
Â  Â  .chip:focus-visible{outline:none; box-shadow:var(--ring);}

Â  Â  .chip.on,
Â  Â  .chip-cons.on {
Â  Â  Â  background:var(--chip-bg-on);Â 
Â  Â  Â  color:var(--chip-fg-on);Â 
Â  Â  Â  border-color:transparent;
Â  Â  }
Â  Â  .chip.on:hover,
Â  Â  .chip-cons.on:hover {
Â  Â  Â  background: var(--blue-hover);
Â  Â  Â  transform: translateY(-1px);
Â  Â  }
Â  Â Â 
Â  Â  /* Cons chip (unselected) */
Â  Â  .chip-cons{
Â  Â  Â  background:var(--chip-bg-cons);
Â  Â  Â  border-color:var(--chip-bg-cons);
Â  Â  Â  color:var(--chip-fg-cons);
Â  Â  }
Â  Â  .chip-cons:not(.on):hover{
Â  Â  Â  background:var(--chip-bg-cons);
Â  Â  Â  transform:translateY(-1px);
Â  Â  }

Â  Â  .chip-text{font-size:var(--fs-chip); font-weight:600; text-align:center; line-height:1.25; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;}
Â  Â  .actions{display:flex; gap:10px; margin:8px 0 8px;}

Â  Â  .btn{flex:1; height:46px; border:0; border-radius:14px; font-weight:800; font-size:var(--fs-btn); display:flex; align-items:center; justify-content:center; text-align:center; cursor:pointer; box-shadow:var(--shadow-soft); transition:transform .08s, background-color .12s, box-shadow .12s; line-height:1.1; padding:0 18px;}
Â  Â  .btn.primary{color:var(--on-blue); background:var(--blue-500); box-shadow:0 6px 16px color-mix(in oklab,var(--blue-500) 14%,transparent);}
Â  Â  .btn.primary:hover{background:var(--blue-hover);}
Â  Â  .btn.primary:active{transform:translateY(1px); background:var(--blue-active);}
Â  Â  .btn.secondary{background:#0B1220; color:#fff; min-height:52px; border-radius:16px; display:flex; align-items:center; justify-content:center; line-height:1;}

Â  Â  .btn{flex:1; height:46px; border:0; border-radius:14px; font-weight:800; font-size:var(--fs-btn); display:flex; align-items:center; justify-content:center; text-align:center; cursor:pointer; box-shadow:var(--shadow-soft); transition:transform .08s, background-color .12s, box-shadow .12s; line-height:1.2;}
Â  Â  .btn{flex:1; height:46px; border:0; border-radius:14px; font-weight:800; font-size:var(--fs-btn); display:flex; align-items:center; justify-content:center; text-align:center; cursor:pointer; box-shadow:var(--shadow-soft); transition:transform .08s, background-color .12s, box-shadow .12s;}
Â  Â  .btn.primary{color:var(--on-blue); background:var(--blue-500); box-shadow:0 6px 16px color-mix(in oklab,var(--blue-500) 14%,transparent);}
Â  Â  .btn.primary:hover{background:var(--blue-hover);}
Â  Â  .btn.primary:active{transform:translateY(1px); background:var(--blue-active);}
Â  Â  .btn.secondary{background:#0B1220; color:#fff; height:52px; border-radius:16px; display:flex; align-items:center; justify-content:center;}

Â  Â  .btn:disabled{opacity:.7; cursor:not-allowed;}
Â  Â  .spinner{width:18px; height:18px; border:2px solid color-mix(in oklab, var(--on-blue) 45%, transparent); border-top-color:var(--on-blue); border-radius:50%; margin-right:8px; display:none; animation:spin .9s linear infinite;}
Â  Â  @keyframes spin{to{transform:rotate(360deg)}}
Â  Â  textarea{width:100%; margin:0; padding:12px 14px; min-height:120px; border:1px solid var(--blue-200); border-radius:14px; font-size:var(--fs-body); box-shadow:var(--shadow-soft);}

.thanks-notice{
Â  margin:12px 0 0;
Â  padding:14px;
Â  border-radius:var(--radius-md);
Â  background:#F3F4F6;
Â  color:#6B7280;
Â  box-shadow:var(--shadow-soft);
Â  font-size:14px;
Â  line-height:1.5;
Â  text-align:center;
}
Â  Â  .footer-actions{ display:none; justify-content:center; margin-top:12px; }
Â  Â  .footer-actions.show{ display:flex; }

Â  Â  #openGoogle.btn.secondary{
Â  Â  Â  display:grid !important;
Â  Â  Â  place-items:center !important;
Â  Â  Â  height:52px !important;
Â  Â  Â  padding:0 18px !important;
Â  Â  Â  line-height:1 !important;
Â  Â  Â  white-space:nowrap;
Â  Â  }
Â  Â  #openGoogle.btn.secondary *{
Â  Â  Â  margin:0 !important;
Â  Â  Â  line-height:1 !important;
Â  Â  }
Â  </style>
</head>
<body>
Â  <div class="wrap">
Â  Â  <div class="card">
Â  Â  Â  <div class="hero-wrap">
Â  Â  Â  Â  <img id="hero" class="hero" alt="hero"/>
Â  Â  Â  Â  <div id="langBar" class="lang-pill" aria-label="language switch"></div>
Â  Â  Â  Â  <div id="logoBadge" class="logo-badge"><img id="logo" alt="logo"/></div>
Â  Â  Â  </div>

Â  Â  Â  <div class="content">
Â  Â  Â  Â  <h1 id="title" class="title">ç‚ºã€Œ<span id="title-store-name">é–€å¸‚</span>ã€å¯«ä¸€å‰‡çŸ­è©•</h1>
Â  Â  Â  Â  <p id="subtitle" class="sub">æŒ‘é¸ä»Šå¤©ä½ æœ€æœ‰æ„Ÿçš„å¹¾å€‹é‡é»ï¼Œæˆ‘å€‘æœƒå¹«ä½ æ•´ç†æˆçŸ­è©•ã€‚</p>

Â  Â  Â  Â  <div id="chip-groups-container"></div>

Â  Â  Â  Â  <div class="actions">
Â  Â  Â  Â  Â  <button id="gen" class="btn primary"></button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <textarea id="output" placeholder="é€™è£¡æœƒé¡¯ç¤ºæ•´ç†å¾Œçš„ä¸€æ®µçŸ­è©•â€¦" style="display:none;"></textarea>

Â  Â  Â  Â  <div id="footerActions" class="footer-actions">
Â  Â  Â  Â  Â  <a id="openGoogle" class="btn secondary" target="_blank" rel="noopener noreferrer">ğŸ“‹ è¤‡è£½ä¸¦é–‹å•Ÿgoogleè©•è«–</a>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="thanksNotice" class="thanks-notice" data-keep-thanks="true" style="display:none;">
Â  Â  Â  Â  Â  <div id="thanksMessage"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="status" class="status" aria-live="polite"></div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <script>
Â  /* ---------- color utils ---------- */
Â  const hexToRgb=h=>{h=h.replace('#',''); if(h.length===3)h=h.split('').map(c=>c+c).join(''); const n=parseInt(h,16); return {r:(n>>16)&255,g:(n>>8)&255,b:n&255}};
Â  const rgbToHex=(r,g,b)=>'#'+[r,g,b].map(v=>('0'+v.toString(16)).slice(-2)).join('');
Â  function rgbToHsl(r,g,b){r/=255;g/=255;b/=255;const M=Math.max(r,g,b),m=Math.min(r,g,b);let h,s,l=(M+m)/2;if(M===m){h=s=0}else{const d=M-m;s=l>0.5?d/(2-M-m):d/(M+m);switch(M){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}h/=6}return{h,s,l}}
Â  function hslToRgb(h,s,l){let r,g,b;if(s===0){r=g=b=l}else{const q=l<0.5?l*(1+s):l+s-l*s,p=2*l-q,f=t=>{if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p};r=f(h+1/3);g=f(h);b=f(h-1/3)}return{r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)}}
Â  const normHex=h=>{if(!h)return'';let s=String(h).trim();if(!s.startsWith('#'))s='#'+s;if(/^#([0-9a-fA-F]{3})$/.test(s)){const[,r,g,b]=s.match(/^#(.)(.)(.)$/);s='#'+r+r+g+g+b+b}return /^#([0-9a-fA-F]{6})$/.test(s)?s.toUpperCase():''};
Â  const lighten=(hex,d)=>{const {r,g,b}=hexToRgb(hex),hsl=rgbToHsl(r,g,b);hsl.l=Math.max(0,Math.min(1,hsl.l+Math.abs(d)));hsl.s=Math.max(0,Math.min(0.92,hsl.s*1.00));const rgb=hslToRgb(hsl.h,hsl.s,hsl.l);return rgbToHex(rgb.r,rgb.g,rgb.b)}
Â  const autoOnColor=bg=>{const {r,g,b}=hexToRgb(bg);const L=0.2126*(r/255)+0.7152*(g/255)+0.0722*(b/255);return (L<0.56)?'#FFFFFF':'#0B1220'}
Â Â 
Â  function applyBlueScale(baseHex,onHex){
Â  Â  const base=normHex(baseHex)||'#0A84FF';
Â  Â  const on=normHex(onHex)||autoOnColor(base);
Â  Â  const root=document.documentElement;
Â  Â  const vars={'--blue-600':base,'--blue-500':base,'--blue-450':lighten(base,.04),'--blue-400':lighten(base,.10),'--blue-300':lighten(base,.20),'--blue-200':lighten(base,.30),'--blue-100':lighten(base,.38),'--blue-050':lighten(base,.45),'--blue-hover':lighten(base,.06),'--blue-active':base,'--on-blue':on};
Â  Â  Object.entries(vars).forEach(([k,v])=>root.style.setProperty(k,v));
Â  Â Â 
Â  Â  root.style.setProperty('--chip-bg','var(--blue-100)');
Â  Â Â 
Â  Â  root.style.setProperty('--chip-bg-on','var(--blue-450)');
Â  Â  root.style.setProperty('--chip-fg-on','var(--on-blue)');
Â  Â Â 
Â  Â  root.style.setProperty('--chip-bg-cons', 'var(--blue-050)');
Â  Â  root.style.setProperty('--chip-fg-cons', 'var(--muted)');
Â  }

Â  /* ---------- helpers ---------- */
Â  function getStoreFromURL(){const url=new URL(location.href);const byQuery=(url.searchParams.get('store')||url.searchParams.get('storeid')||'').trim();if(byQuery)return byQuery;const parts=url.pathname.replace(/^\/+/,'').split('/');const first=(parts[0]||'').trim().toLowerCase();if(!first||first==='index.html'||first==='favicon.ico'||first==='api')return'';if(first==='s'&&parts[1])return(parts[1]||'').trim();return parts[0]||''}
Â  const uniq=a=>Array.from(new Set((a||[]).map(s=>String(s||'').trim()).filter(Boolean)));
Â  const pick=(o,...keys)=>{for(const k of keys){const v=o&&o[k];if(v!==undefined&&v!==null&&String(v).trim()!=='')return v}return''}
Â  const withBuster=u=>(!u?'':(u+(u.includes('?')?'&':'?')+'v='+Date.now()))
Â  function setImgEl(imgEl,url,fallback,wrapper){const show=ok=>((wrapper||imgEl).style.display= ok?((wrapper||imgEl).classList.contains('hero')?'block':'flex'):'none');const src=url||fallback;if(!src)return show(false);imgEl.onload=()=>show(true);imgEl.onerror=()=>show(false);imgEl.src=withBuster(src)}

Â  function parseStoreNameMulti(s){
Â  Â  const out={zh:'',en:'',ko:'',ja:'',fr:'',es:'',_raw:(s||'').trim()}; if(!s) return out;
Â  Â  const str=String(s).trim();
Â  Â  if(/[a-z]{2}\s*=/.test(str)){str.split(',').forEach(p=>{const[k,v]=p.split('=');if(!k||!v)return;const kk=k.trim().toLowerCase();const vv=v.trim();if(out.hasOwnProperty(kk))out[kk]=vv});return out;}
S
Â  Â  const parts=str.split(',').map(x=>x.trim()).filter(Boolean);
Â  Â  const isLatin=t=>/[A-Za-z]/.test(t), isKo=t=>/[ê°€-í£]/.test(t), isJa=t=>/[\u3040-\u30ff\u31f0-\u31ff\uFF66-\uFF9D]/.test(t);
Â  Â  parts.forEach(p=>{ if(!out.en&&isLatin(p)){out.en=p;return} if(!out.ko&&isKo(p)){out.ko=p;return} if(!out.ja&&isJa(p)){out.ja=p;return} if(!out.zh){out.zh=p;return}});
Â  Â  return out;
Â  }
Â  function storeNameForLang(map,lang){
Â  Â  if(!map) return '';
Â  Â  const order={zh:['zh','en','ko','ja','fr','es'],en:['en','zh','ko','ja','fr','es'],ko:['ko','zh','en','ja','fr','es'],ja:['ja','zh','en','ko','fr','es'],fr:['fr','en','zh','ko','ja','es'],es:['es','en','zh','ko','ja','fr']}[lang]||['en','zh','ko','ja','fr','es'];
Â  Â  for(const k of order){const v=(map[k]||'').trim(); if(v) return v} return (map._raw||'').trim();
Â  }

Â  // âœ… [ä¿®æ”¹] èˆŠçš„ LANGS.chips é™£åˆ—å·²ä¸å†éœ€è¦ï¼Œä½†ä¿ç•™ UI éƒ¨åˆ†
  
  // ==========================================================
  // âœ… [å·²æ›´æ–°] - ä»¥ä¸‹æ˜¯æ‰€æœ‰èªè¨€çš„ "å•å·é¢¨æ ¼" æ–‡æ¡ˆ
  // ==========================================================
Â  const LANGS={
Â  Â  en:{label:'EN',ui:{title:'Share your experience at "{name}"',sub:'Thank you for visiting! Please tap a few highlightsâ€”your feedback helps us improve.',gen:'âœï¸ Generate & Claim Reward',open:'Copy & Open Google',placeholder:'Your summarized review will appear hereâ€¦'}},
Â  Â  zh:{label:'ä¸­',ui:{title:'åˆ†äº«æ‚¨åœ¨ã€Œ{name}ã€çš„ç”¨é¤é«”é©—',sub:'æ„Ÿè¬æ‚¨çš„å…‰è‡¨ï¼é»é¸å¹¾å€‹é‡é»ï¼Œæ‚¨çš„å›é¥‹å°‡å¹«åŠ©æˆ‘å€‘åšå¾—æ›´å¥½ã€‚',gen:'âœï¸ ç”¢ç”Ÿè©•è«–ä¸¦é ˜å–çå‹µ',open:'ğŸ“‹ è¤‡è£½ä¸¦é–‹å•Ÿgoogleè©•è«–',placeholder:'é€™è£¡æœƒé¡¯ç¤ºæ•´ç†å¾Œçš„ä¸€æ®µçŸ­è©•â€¦'}},
Â  Â  ko:{label:'í•œêµ­ì–´',ui:{title:'"{name}" ë°©ë¬¸ ê²½í—˜ì„ ê³µìœ í•´ ì£¼ì„¸ìš”',sub:'ë°©ë¬¸í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ëª‡ ê°€ì§€ í•­ëª©ì„ ì„ íƒí•´ ì£¼ì‹œë©´ ì„œë¹„ìŠ¤ ê°œì„ ì— í° ë„ì›€ì´ ë©ë‹ˆë‹¤.',gen:'âœï¸ ì‘ì„± ë° ë¦¬ì›Œë“œ ë°›ê¸°',open:'ğŸ“‹ ë³µì‚¬ ë° Google ì—´ê¸°',placeholder:'ìš”ì•½ëœ ë¦¬ë·°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤â€¦'}},
Â  Â  ja:{label:'æ—¥æœ¬èª',ui:{title:'ã€Œ{name}ã€ã§ã®ã”åˆ©ç”¨ä½“é¨“ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ',sub:'ã”æ¥åº—ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã„ãã¤ã‹ã®é …ç›®ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚ãŠå®¢æ§˜ã®å£°ãŒç§ãŸã¡ã®ã‚µãƒ¼ãƒ“ã‚¹å‘ä¸Šã«ç¹‹ãŒã‚Šã¾ã™ã€‚',gen:'âœï¸ ä½œæˆã—ã¦ç‰¹å…¸ã‚’å—ã‘å–ã‚‹',open:'ğŸ“‹ ã‚³ãƒ”ãƒ¼ã—ã¦ Google ã‚’é–‹ã',placeholder:'è¦ì•½ã—ãŸãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™â€¦'}},
Â  Â  fr:{label:'FR',ui:{title:'Partagez votre expÃ©rience chez Â« {name} Â»',sub:'Merci de votre visite ! SÃ©lectionnez quelques points clÃ©s. Vos commentaires nous aident Ã  nous amÃ©liorer.',gen:'âœï¸ RÃ©diger & RÃ©compense',open:'ğŸ“‹ Copier & Ouvrir Google',placeholder:'Votre avis synthÃ©tisÃ© sâ€™affichera iciâ€¦'}},
Â  Â  es:{label:'ES',ui:{title:'Comparta su experiencia en Â«{name}Â»',sub:'Â¡Gracias por su visita! Seleccione algunos puntos destacados. Su opiniÃ³n nos ayuda a mejorar.',gen:'âœï¸ Redactar y Reclamar',open:'ğŸ“‹ Copier y Abrir Google',placeholder:'AquÃ­ aparecerÃ¡ tu reseÃ±aâ€¦'}}
Â  };
  // ==========================================================
  // âœ… [å·²æ›´æ–°] - ä»¥ä¸Šæ˜¯æ‰€æœ‰èªè¨€çš„ "å•å·é¢¨æ ¼" æ–‡æ¡ˆ
  // ==========================================================
Â  Â Â 
Â  const CONS_FIELDS = new Set(['consEn','consCn','consKo','consJa','consFr','consEs','cons']);

Â  // âœ… [æ–°å¢] "å•å·" ç¾¤çµ„çš„æ¨™é¡Œå’Œæ¬„ä½å®šç¾©
Â  const CHIP_GROUPS_CONFIG = [
Â  Â  {
Â  Â  Â  id: 'food',
Â  Â  Â  // å®šç¾©æ­¤ç¾¤çµ„è¦æŠ“å–çš„ "åŸºç¤" æ¬„ä½
Â  Â  Â  keys: ['top3', 'newItems'],Â 
Â  Â  Â  title: {
Â  Â  Â  Â  zh: "ä»Šå¤©æœ€æœ‰å°è±¡çš„é¤é»ï¼Ÿ",
Â  Â  Â  Â  en: "What did you enjoy most about the food?",
Â  Â  Â  Â  ko: "ì˜¤ëŠ˜ ê°€ì¥ ì¸ìƒ ê¹Šì—ˆë˜ ë©”ë‰´ëŠ” ë¬´ì—‡ì¸ê°€ìš”?",
Â  Â  Â  Â  ja: "ä»Šæ—¥æœ€ã‚‚å°è±¡ã«æ®‹ã£ãŸãŠæ–™ç†ã¯ï¼Ÿ",
Â  Â  Â  Â  fr: "Qu'avez-vous le plus apprÃ©ciÃ© dans les plats ?",
Â  Â  Â  Â  es: "Â¿QuÃ© fue lo que mÃ¡s le gustÃ³ de la comida?"
Â  Â  Â  }
Â  Â  },
Â  Â  {
Â  Â  Â  id: 'features',
Â  Â  Â  keys: ['features'],
Â  Â  Â  title: {
Â  Â  Â  Â  zh: "æœ‰å“ªäº›è®“ä½ å°è±¡æ·±åˆ»çš„ç‰¹è‰²ï¼Ÿ",
Â  Â  Â  Â  en: "What features stood out to you?",
Â  Â  Â  Â  ko: "ì¸ìƒ ê¹Šì—ˆë˜ íŠ¹ì§•ì´ ìˆë‚˜ìš”?",
Â  Â  Â  Â  ja: "å°è±¡ã«æ®‹ã£ãŸç‰¹å¾´ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
Â  Â  Â  Â  fr: "Quelles caractÃ©ristiques vous ont marquÃ© ?",
Â  Â  Â  Â  es: "Â¿QuÃ© caracterÃ­sticas le parecieron notables?"
Â  Â  Â  }
Â  Â  },
Â  Â  {
Â  Â  Â  id: 'occasion',
Â  Â  Â  keys: ['ambiance'],
Â  Â  Â  title: {
Â  Â  Â  Â  zh: "é€™æ¬¡çš„ç”¨é¤å ´åˆæ˜¯ï¼Ÿ",
Â  Â  Â  Â  en: "What was the occasion for this visit?",
Â  Â  Â  Â  ko: "ì´ë²ˆ ë°©ë¬¸ ëª©ì ì€ ë¬´ì—‡ì´ì—ˆë‚˜ìš”?",
Â  Â  Â  Â  ja: "ä»Šå›ã®åˆ©ç”¨ã‚·ãƒ¼ãƒ³ã¯ï¼Ÿ",
Â  Â  Â  Â  fr: "Quelle Ã©tait l'occasion de cette visite ?",
Â  Â  Â  Â  es: "Â¿CuÃ¡l fue el motivo de su visita?"
Â  Â  Â  }
Â  Â  },
Â  Â  {
Â  Â  Â  id: 'suggestions',
Â  Â  Â  keys: ['cons'], // å°æ‡‰åˆ° 'consCn', 'consEn' ç­‰
Â  Â  Â  isConsGroup: true, // æ¨™è¨˜ç‚º Cons ç¾¤çµ„
Â  Â  Â  title: {
Â  Â  Â  Â  zh: "æœ‰ä»€éº¼æˆ‘å€‘å¯ä»¥åšå¾—æ›´å¥½çš„åœ°æ–¹ï¼Ÿ(é¸å¡«)",
Â  Â  Â  Â  en: "Anything we can do better? (Optional)",
Â  Â  Â  Â  ko: "ê°œì„ í•  ì ì´ ìˆì„ê¹Œìš”? (ì„ íƒ ì‚¬í•­)",
Â  Â  Â  Â  ja: "æ”¹å–„ã§ãã‚‹ç‚¹ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ (ä»»æ„)",
Â  Â  Â  Â  fr: "Pouvons-nous nous amÃ©liorer ? (Optionnel)",
Â  Â  Â  Â  es: "Â¿Hay algo que podamos mejorar? (Opcional)"
Â  Â  Â  }
Â  Â  }
Â  ];

Â  /* ---------- DOM ---------- */
Â  // âœ… [ä¿®æ”¹] $chips å’Œ $consHint å·²è¢«æ›¿æ›
Â  const $chipGroupsContainer=document.getElementById('chip-groups-container');
Â  const $gen=document.getElementById('gen');
Â  const $openGoogle=document.getElementById('openGoogle');
Â  const $output=document.getElementById('output');
Â  const $status=document.getElementById('status');
Â  const $logo=document.getElementById('logo');
Â  const $logoBadge=document.getElementById('logoBadge');
Â  const $hero=document.getElementById('hero');
Â  const $langBar=document.getElementById('langBar');
Â  const $title=document.getElementById('title');
Â  const $subtitle=document.getElementById('subtitle');
Â  const $titleStoreName=document.getElementById('title-store-name');
Â  const $thanksNotice=document.getElementById('thanksNotice');
Â  const $thanksMessage=document.getElementById('thanksMessage');

Â  let selected=new Map();
Â  let currentStore=getStoreFromURL()||'leegarnei';
Â  let currentLang='zh';
Â  let storeMeta=null, availableLangs=[], storeNames=null;
Â  let googleReviewUrl_global='';
Â  let isGenerated=false;

Â  const genButtonTemplate=()=>`<span class="spinner"></span><span id="btnGen">${LANGS[currentLang].ui.gen}</span>`;

Â  $openGoogle.style.display='none';

Â  function applyBasicLinks(nameText){
Â  Â  $titleStoreName.textContent=nameText||currentStore||'Store';
Â  Â  const q=encodeURIComponent(currentStore||'Big Way');
Â  Â  $openGoogle.href='https://www.google.com/search?q='+q+'+google+reviews';
Â  Â  googleReviewUrl_global=$openGoogle.href;
Â  }

Â  // âœ… [ä¿®æ”¹] langHasContent é‚è¼¯æ›´æ–°ï¼Œä»¥åŒ¹é…æ–°çµæ§‹
Â  function langHasContent(langKey,data){
Â  Â  if(!data) return false;
Â  Â  // æª¢æŸ¥æ‰€æœ‰å¯èƒ½çš„æ¬„ä½
Â  Â  const suffix = (langKey === 'zh') ? 'Cn' : (langKey.charAt(0).toUpperCase() + langKey.slice(1));
Â  Â  const keysToCheck = ['top3','features','ambiance','newItems','cons', `top3${suffix}`, `features${suffix}`, `ambiance${suffix}`, `newItems${suffix}`, `cons${suffix}`];
Â  Â  return keysToCheck.some(k => (data[k] || '').trim());
Â  }

Â  function buildLangBar(){
Â  Â  $langBar.innerHTML='';
Â  Â  availableLangs.forEach(k=>{
Â  Â  Â  const btn=document.createElement('button');
Â  Â  Â  btn.textContent=LANGS[k].label; btn.className=(k===currentLang)?'active':'';
Â  Â  Â  btn.onclick=()=>{currentLang=k; renderUI(); buildLangBar(); buildChipsFromMeta();};
Â  Â  Â  $langBar.appendChild(btn);
Â  Â  });
Â  }

Â  function fitTitle(){
Â  Â  const max=parseInt(getComputedStyle(document.documentElement).getPropertyValue('--fs-title-max'))||28;
Â  Â  const min=parseInt(getComputedStyle(document.documentElement).getPropertyValue('--fs-title-min'))||18;
Â  Â  let size=max; $title.style.fontSize=size+'px'; const w=$title.clientWidth;
Â  Â  while($title.scrollWidth>w && size>min){ size-=1; $title.style.fontSize=size+'px'; }
Â  }

Â  function renderUI(){
Â  Â  const ui=LANGS[currentLang].ui;
Â  Â  const localizedName=storeNameForLang(storeNames,currentLang)||pick(storeMeta,'name')||currentStore||'Store';
Â  Â  $title.innerHTML=ui.title.replace('{name}',`<span id="title-store-name">${localizedName}</span>`);
Â  Â  $subtitle.textContent=ui.sub;
Â  Â  $gen.innerHTML=genButtonTemplate();
Â  Â  $openGoogle.textContent=ui.open;
Â  Â  $output.placeholder=ui.placeholder;

Â  Â  const thanksCopy={
Â  Â  Â  zh:'æ„Ÿè¬æ‚¨æä¾›å¯¶è²´å›é¥‹ã€‚<b>è«‹å‡ºç¤ºæ­¤ç•«é¢</b>å³å¯å‘åº—å“¡å…Œæ›',
Â  Â  Â  en:'Thank you for your feedback. <b>Show this screen</b> to redeem with the staff.',
Â  Â  Â  ko:'ì†Œì¤‘í•œ ì˜ê²¬ ê°ì‚¬í•©ë‹ˆë‹¤. <b>ì´ í™”ë©´ì„ ì œì‹œ</b>í•˜ì‹œë©´ ì§ì›ì´ ë¦¬ì›Œë“œë¥¼ ë“œë¦½ë‹ˆë‹¤.',
A
Â  Â  Â  ja:'ã”æ„è¦‹ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<b>ã“ã®ç”»é¢ã‚’ã”æç¤º</b>ã„ãŸã ãã¨ã‚¹ã‚¿ãƒƒãƒ•ã‹ã‚‰ç‰¹å…¸ã‚’å—ã‘å–ã‚Œã¾ã™ã€‚',
Â  Â  Â  fr:'Merci pour votre avis. <b>PrÃ©sentez cet Ã©cran</b> pour lâ€™Ã©changer auprÃ¨s du personnel.',
Â  Â  Â  es:'Gracias por tu opiniÃ³n. <b>Muestra esta pantalla</b> al personal para canjearla.'
Â  Â  }[currentLang]||'Thank you for your feedback. <b>Show this screen</b> to redeem with the staff.';
Â  Â  $thanksMessage.innerHTML=thanksCopy;

Â  Â  const hasReview = isGenerated && ($output.value||'').trim()!=='';

Â  Â  $thanksNotice.style.display = hasReview ? 'block' : 'none';
Â  Â  $output.style.displayÂ  Â  Â  Â = hasReview ? 'block' : 'none';

Â  Â  const $footerActions = document.getElementById('footerActions');
Â  Â  if ($footerActions){
Â  Â  Â  $footerActions.classList.toggle('show', hasReview);
Â  Â  Â  $openGoogle.style.display = hasReview ? 'block' : 'none';
Course
Â  Â  }else{
Â  Â  Â  $openGoogle.style.display = hasReview ? 'block' : 'none';
Â  Â  }

Â  Â  $openGoogle.setAttribute('aria-hidden', hasReview ? 'false' : 'true');
Â  Â  $openGoogle.tabIndex = hasReview ? 0 : -1;

Â  Â  requestAnimationFrame(fitTitle);
Â  }

Â  // âœ… [ä¿®æ”¹] "buildChipsFromMeta" å‡½å¼å·²å®Œå…¨é‡å¯«ç‚º "å•å·" ç”¢ç”Ÿå™¨
Â  function buildChipsFromMeta(){
Â  Â  const data = storeMeta || {};
Â  Â  $chipGroupsContainer.innerHTML = '';
Â  Â  selected.clear();
Â  Â Â 
Â  Â  // ç”¨ä¾†è¿½è¹¤ä¸€å€‹æ¨™ç±¤æ˜¯å¦å·²è¢«æ¸²æŸ“ï¼Œé˜²æ­¢é‡è¤‡ (ä¾‹å¦‚ 'top3' å’Œ 'top3Cn' éƒ½æœ‰)
Â  Â  const allTagsRendered = new Set();
Â  Â  const langSuffix = (currentLang === 'zh') ? 'Cn' : (currentLang.charAt(0).toUpperCase() + currentLang.slice(1));

Â  Â  CHIP_GROUPS_CONFIG.forEach(group => {
Â  Â  Â  const isConsGroup = !!group.isConsGroup;
Â  Â  Â Â 
Â  Â  Â  // 1. å–å¾—æ­¤ç¾¤çµ„è¦æŠ“å–çš„æ‰€æœ‰ key (ä¾‹å¦‚ 'top3Cn', 'newItemsCn', 'top3', 'newItems')
Â  Â  Â  const keysForLang = [];
Â  Â  Â  group.keys.forEach(baseKey => {
Â  Â  Â  Â  keysForLang.push(baseKey + langSuffix); // 'top3' -> 'top3Cn'
Â  Â  Â  Â  keysForLang.push(baseKey); // 'top3'
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  const seenInThisGroup = new Map();
Â  Â  Â Â 
Â  Â  Â  // 2. å¾ storeMeta æ’ˆå–è³‡æ–™
Â  Â  Â  keysForLang.forEach(key => {
Â  Â  Â  Â  const raw = data[key] || ''; // ç›´æ¥ç”¨ key è¨ªå• (e.g., data['top3Cn'])
Â  Â  Â  Â  if (raw) {
Â  Â  Â  Â  Â  String(raw).split(',').forEach(tag => {
Â  Â  Â  Â  Â  Â  const t = (tag || '').trim();
Â  Â  Â  Â  Â  Â  // å¦‚æœæ¨™ç±¤æœ‰æ•ˆï¼Œä¸” "æ‰€æœ‰ç¾¤çµ„" éƒ½æ²’é¡¯ç¤ºé
Â  Â  Â  Â  Â  Â  if (t && !allTagsRendered.has(t)) {
Â  Â  Â  Â  Â  Â  Â  // ä¸” "æ­¤ç¾¤çµ„å…§" ä¹Ÿæ²’é‡è¤‡
Â  Â  Â  Â  Â  Â  Â  if (!seenInThisGroup.has(t)) {
Â  Â  Â  Â  Â  Â  Â  Â  seenInThisGroup.set(t, { tag: t, isCons: isConsGroup });
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  const uniqueTagsData = Array.from(seenInThisGroup.values());
Â  Â  Â Â 
Â  Â  Â  // 3. å¦‚æœæ­¤ç¾¤çµ„æ²’æœ‰ä»»ä½• *æ–°* æ¨™ç±¤ï¼Œå°±è·³éï¼Œä¸æ¸²æŸ“æ¨™é¡Œ
Â  Â  Â  if (uniqueTagsData.length === 0) {
Â  Â  Â  Â  return;Â 
Â  Â  Â  }

Â  Â  Â  // 4. å»ºç«‹ DOM
Â  Â  Â  const $groupWrapper = document.createElement('div');
Â  Â  Â  $groupWrapper.className = 'chip-group';
Â  Â  Â  if (isConsGroup) $groupWrapper.classList.add('cons-group');

Â  Â  Â  const $groupTitle = document.createElement('h3');
Â  Â  Â  $groupTitle.className = 'chip-group-title';
Â  Â  Â  $groupTitle.textContent = group.title[currentLang] || group.title['en'];
Â  Â  Â Â 
Â  Â  Â  const $chipsGrid = document.createElement('div');
Â  Â  Â  $chipsGrid.className = 'chips';

Â  Â  Â  uniqueTagsData.forEach(({ tag, isCons }) => {
Â  Â  Â  Â  allTagsRendered.add(tag); // æ¨™è¨˜ç‚ºå·²æ¸²æŸ“
Â  Â  Â  Â Â 
Â  Â  Â  Â  const el = document.createElement('div');
Â  Â  Â  Â  el.className = isCons ? 'chip chip-cons' : 'chip';
Â  Â  Â  Â  el.innerHTML = `<span class="chip-text">${tag.trim()}</span>`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // é»æ“Šé‚è¼¯ä¸è®Š (æ“ä½œå…¨åŸŸçš„ 'selected' Map)
Â  Â  Â  Â  el.onclick = () => {
Â  Â  Â  Â  Â  if (selected.has(tag)) {
Â  Â  Â  Â  Â  Â  selected.delete(tag);
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  selected.set(tag, { isCons: isCons });
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  el.classList.toggle('on');
Â  Â  Â  Â  };
Â  Â  Â  Â  $chipsGrid.appendChild(el);
Â  Example
Â  Â  Â  });

Â  Â  Â  $groupWrapper.appendChild($groupTitle);
Â  Â  Â  $groupWrapper.appendChild($chipsGrid);
Â  Â  Â  $chipGroupsContainer.appendChild($groupWrapper);
Â  Â  });
Â  Â Â 
Â  Â  // 5. Fallback (å¦‚æœæ‰€æœ‰ç¾¤çµ„éƒ½æ²’è³‡æ–™)
Â  Â  if ($chipGroupsContainer.innerHTML === '') {
Â  Â  Â  Â $chipGroupsContainer.innerHTML = `<p style="color:var(--muted); margin:10px 4px;">(${LANGS[currentLang]?.ui?.sub || 'Please select your feedback.'})</p>`;
Â  Â  }
Â  }

Â  function applyThemeFromMeta(d){
Â  Â  const apiBlue=(pick(d,'themeBlue')||'').trim();
Â  Â  const apiOn=(pick(d,'themeOnBlue')||'').trim();
Â  Â  const cssBase=getComputedStyle(document.documentElement).getPropertyValue('--blue').trim()||'#0A84FF';
Â  Â  applyBlueScale(apiBlue||cssBase,apiOn);
Â  }

Â  async function loadStoreMeta(){
Â  Â  try{
Â  Â  Â  const res=await fetch('/api/store?storeid='+encodeURIComponent(currentStore));
Â  Â  Â  const data=await res.json(); if(!res.ok) throw new Error(data?.error||('HTTP '+res.status));
Â  Â  Â  storeMeta=data; applyThemeFromMeta(data);
Â  Â  Â  storeNames=parseStoreNameMulti(pick(data,'name','storeName','title')||currentStore);
Â  Â  Â  applyBasicLinks(storeNameForLang(storeNames,currentLang));
Â  Â  Â  const order=['zh','en','ko','ja','fr','es']; availableLangs=order.filter(k=>langHasContent(k,data));
V
Â  Â  Â  if(availableLangs.length===0) availableLangs=['zh','en']; if(!availableLangs.includes(currentLang)) currentLang=availableLangs[0];
Â  Â  Â  const heroUrl=pick(data,'heroUrl','cover','banner','placePhotoUrl','photoUrl');
Â  Â  Â  const logoUrl=pick(data,'logoUrl','logo','image','icon');
Â  Â  Â  setImgEl($hero,heroUrl,pick(data,'placePhotoUrl','photoUrl'));
Â  Â  Â  setImgEl($logo,logoUrl,pick(data,'placePhotoUrl','photoUrl'),$logoBadge);
Â  Â  Â  if(data.placeId){ const url='https://search.google.com/local/writereview?placeid='+encodeURIComponent(data.placeId); $openGoogle.href=url; googleReviewUrl_global=url; }
Â  Â  Â  renderUI(); buildLangBar(); buildChipsFromMeta();
Â  Â  }catch(e){
Â  Â  Â  const cssBase=getComputedStyle(document.documentElement).getPropertyValue('--blue').trim()||'#0A84FF';
Â  Â  Â  applyBlueScale(cssBase,''); storeNames=parseStoreNameMulti(currentStore);
Â  Â  Â  applyBasicLinks(storeNameForLang(storeNames,currentLang)); renderUI(); buildLangBar(); buildChipsFromMeta();
Â  Â  }
Â  }

Â  (function init(){const cssBase=getComputedStyle(document.documentElement).getPropertyValue('--blue').trim()||'#0A84FF'; applyBlueScale(cssBase,'');})();
Â  applyBasicLinks('Store'); renderUI(); loadStoreMeta(); addEventListener('resize',()=>requestAnimationFrame(fitTitle));

Â  $openGoogle.addEventListener('click', async (e)=>{
Â  Â  e.preventDefault();
Â  Â  const txt=($output.value||'').trim();
Â  Â  if(!txt){ $status.textContent='å°šç„¡å…§å®¹å¯è¤‡è£½'; return; }
style
Â  Â  try{ await navigator.clipboard.writeText(txt); $status.textContent=''; }catch{ $status.textContent='è«‹æ‰‹å‹•è¤‡è£½'; }
Â  Â  try{ window.open(googleReviewUrl_global,'_blank'); }catch{}
Â  });

Â  async function generate(){
Â  Â  const storeid=(currentStore||'').trim();
Â  Â  if(!storeid){ $status.textContent=(currentLang==='zh')?'è«‹å…ˆæŒ‡å®š StoreIDã€‚':'Please set StoreID first.'; return; }

EOT
Â  Â  const allSelections = Array.from(selected.entries());
Â  Â  const positiveTags = allSelections.filter(([, data]) => !data.isCons).map(([tag]) => tag);
Â  Â  const consTags = allSelections.filter(([, data]) => data.isCons).map(([tag]) => tag);
Â  Â Â 
Â  Â  if(positiveTags.length === 0 && consTags.length === 0){ $status.textContent={en:'Please select at least one tag.', zh:'è«‹è‡³å°‘é¸æ“‡ä¸€å€‹æ¨™ç±¤ã€‚'}[currentLang]||'Please select at least one tag.'; return; }
Â  Â Â 
Â  Â  const body={
Â  Â  Â  storeid,
Â  Â  Â  positiveTags,
Â  Â  Â  consTags,
Â  Â  Â  variant:1, minChars:90, maxChars:160, lang:currentLang
Â  Â  };

Â  Â  $gen.classList.add('loading'); $gen.disabled=true;
Â  Â  $gen.innerHTML=`<span class="spinner"></span>${{en:'Composingâ€¦',zh:'æ’°å¯«ä¸­â€¦'}[currentLang]||'Composingâ€¦'}`;
Â  Â  $status.textContent='';

Â  Â  try{
Â  Â  Â  const res=await fetch('/api/generate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});
Â  Â  Â  const data=await res.json(); if(!res.ok) throw new Error(data?.error||('HTTP '+res.status));

Â  Â  Â  const reviewText=data.reviewText||''; $output.value=reviewText;
Â  Â  Â  if(data?.store?.placeId){
Â  Â  Â  Â  googleReviewUrl_global='https://search.google.com/local/writereview?placeid='+encodeURIComponent(data.store.placeId);
Â  Â  Â  Â  $openGoogle.href=googleReviewUrl_global;
Â  Â  Â  }

Â  Â  Â  isGenerated=true;
Â  Â  Â  renderUI();

Â  Â  Â  $status.textContent=({zh:'âœ… è©•è«–å·²ç”¢ç”Ÿï¼',en:'âœ… Review generated!'}[currentLang]||'âœ… Done')+' ('+(data.latencyMs||'-')+' ms)';
Â  Â  }catch(err){
Â  Â  Â  $status.textContent=({zh:'âŒ ç™¼ç”ŸéŒ¯èª¤ï¼š',en:'âŒ Error: '}[currentLang]||'âŒ Error: ')+err.message;
S
Â  Â  }finally{
Â  Â  Â  $gen.classList.remove('loading'); $gen.disabled=false; $gen.innerHTML=genButtonTemplate();
Â  Â  }
Â  }

Â  document.getElementById('gen').addEventListener('click', generate);
Â  </script>

Â  <script>
Â  (function hotfix(){
Â  Â  // âœ… [ä¿®æ”¹] $chips å·²è¢« $chipGroupsContainer æ›¿æ›
Code
Â  Â  const $chipContainer = document.getElementById('chip-groups-container');
Â  Â  const output = document.getElementById('output');
Â  Â  const openBtn = document.getElementById('openGoogle');
Â  Â  const status = document.getElementById('status');

Â  Â  if ($chipContainer) {
Â  Â  Â  const mo = new MutationObserver(()=>{
Â  Â  Â  Â  // ç¢ºä¿å®ƒä¿æŒå¯è¦‹ (é›–ç„¶ç¾åœ¨æ˜¯ç¾¤çµ„ï¼Œé‚è¼¯ä¾ç„¶é©ç”¨)
Â  Â  Â  Â  $chipContainer.style.display='block';
Â  Â  Â  Â  $chipContainer.hidden=false;
Â  Â  Â  });
Â  Â  Â  mo.observe(document.body,{childList:true,subtree:true});
Â  Â  }

Â  Â  const _open = window.open;
Â  Â  window.open = function(url, target, features){
Â  Â  Â  const fromBtn = (document.activeElement === openBtn) || (url && String(url).includes('writereview'));
Â  Â  Â  return fromBtn ? _open.call(window, url, target, features) : null;
Â  Â  };

Â  Â  const killThanks = ()=>{
Â  Â  Â  document.querySelectorAll('*').forEach(el=>{
Â  Â  Â  Â  const t=(el.textContent||'').trim();
Example
Â  Â  Â  Â  const keep = el.closest('[data-keep-thanks="true"]');
Â  Â  Â  Â  if ((t.includes('æ„Ÿè¬æ‚¨çš„å›é¥‹') || t.includes('æˆ‘å€‘å·²ç‚ºæ‚¨é–‹å•Ÿ Google è©•è«–åˆ†é ')) && !keep) {
Â  Â  Â  Â  Â  if ($chipContainer && !el.contains($chipContainer) && el.remove) el.remove();
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  };
Â  Â  new MutationObserver(killThanks).observe(document.body,{childList:true,subtree:true});
Â  Â  killThanks();

Â  Â  openBtn && openBtn.addEventListener('click', async (e)=>{
Â  Â  Â  e.preventDefault();
Â  Â  Â  const txt=(output.value||'').trim();
Â  Â  Â  if(!txt){ status && (status.textContent='å°šç„¡å…§å®¹å¯è¤‡è£½'); return; }
Â  Â  Â  try{ await navigator.clipboard.writeText(txt); status && (status.textContent=''); }catch{ status && (status.textContent='è«‹æ‰‹å‹•è¤‡è£½'); }
Â  Â  Â  try{ _open.call(window, window.googleReviewUrl_global || openBtn.href, '_blank'); }catch{}
Â  Â  }, { capture:false });
Â  })();
Â  </script>
</body>
</html>
